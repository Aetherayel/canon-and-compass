---
/**
 * Props:
 *  - title: string
 *  - data: {
 *      root: string,
 *      rootReflection?: string,
 *      trunk: string,
 *      trunkReflection?: string,
 *      branches: string[],
 *      branchesReflection?: string,
 *      leaves: string[],
 *      leavesReflection?: string,
 *      fruit: string[],
 *      fruitReflection?: string,
 *    }
 */
const { title = "Truth Tree Walkthrough", data = {} } = Astro.props;

const {
  root = "Root truth goes here.",
  rootReflection = "What single phrase from this truth would you like to remember today?",
  trunk = "The theological trunk that supports it.",
  trunkReflection = "How does this belief shape decisions you make this week?",
  branches = [],
  branchesReflection = "Pick one branch and notice when it shows up in your day.",
  leaves = [],
  leavesReflection = "What’s one small way you could practice this truth today?",
  fruit = [],
  fruitReflection = "Which of these outcomes do you most want to cultivate?",
} = data;
---

<style>
  .ttw-summary::marker { display: none; }
  .ttw-summary { cursor: pointer; }
  .ttw-arrow { transition: transform .25s ease; }
  details[open] .ttw-arrow { transform: rotate(90deg); }
  .ttw-content { transition: opacity .28s ease, transform .28s ease; transform-origin: top center; }
  details:not([open]) .ttw-content { opacity: 0; transform: translateY(-6px) scale(.995); height: 0; overflow: hidden; }
  details[open] .ttw-content { opacity: 1; transform: translateY(0) scale(1); height: auto; }
</style>

<div class="bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-2xl p-6 space-y-4 shadow-sm">
  <div class="flex items-start justify-between gap-4">
    <div>
      <h3 class="text-lg font-serif font-semibold text-slate-800 dark:text-zinc-100">{title}</h3>
      <p class="mt-1 text-sm text-zinc-500 dark:text-zinc-400 max-w-prose">
        Walk through the core parts of this tree, starting with the root of truth and tracing it to the fruit it produces. Expand each section for reflection prompts and Scripture to anchor the truth.
      </p>
    </div>
  </div>

  <div class="mt-4 space-y-3">
    <!-- Root -->
    <details class="rounded-lg" role="group">
      <summary class="ttw-summary flex items-center gap-3 p-3 rounded-md hover:bg-zinc-50 dark:hover:bg-zinc-700">
        <svg class="ttw-arrow w-4 h-4 text-zinc-500" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
        <div class="text-sm font-medium text-slate-800 dark:text-zinc-100"> Root — Core biblical truth</div>
      </summary>
      <div class="ttw-content p-4 bg-zinc-50 dark:bg-zinc-900 rounded-b-md">
        <p class="text-sm text-zinc-700 dark:text-zinc-300">{root}</p>
        <div class="mt-3 text-xs text-zinc-500 dark:text-zinc-400">
          <strong>Reflect:</strong> {rootReflection}
        </div>
      </div>
    </details>

    <!-- Trunk -->
    <details class="rounded-lg" role="group">
      <summary class="ttw-summary flex items-center gap-3 p-3 rounded-md hover:bg-zinc-50 dark:hover:bg-zinc-700">
        <svg class="ttw-arrow w-4 h-4 text-zinc-500" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
        <div class="text-sm font-medium text-slate-800 dark:text-zinc-100"> Trunk — Foundational belief</div>
      </summary>
      <div class="ttw-content p-4 bg-zinc-50 dark:bg-zinc-900 rounded-b-md">
        <p class="text-sm text-zinc-700 dark:text-zinc-300">{trunk}</p>
        <div class="mt-3 text-xs text-zinc-500 dark:text-zinc-400">
          <strong>Reflect:</strong> {trunkReflection}
        </div>
      </div>
    </details>

    <!-- Branches -->
    <details class="rounded-lg" role="group">
      <summary class="ttw-summary flex items-center gap-3 p-3 rounded-md hover:bg-zinc-50 dark:hover:bg-zinc-700">
        <svg class="ttw-arrow w-4 h-4 text-zinc-500" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
        <div class="text-sm font-medium text-slate-800 dark:text-zinc-100"> Branches — Reinforcing patterns</div>
      </summary>
      <div class="ttw-content p-4 bg-zinc-50 dark:bg-zinc-900 rounded-b-md">
        <ul class="list-disc list-inside text-sm text-zinc-700 dark:text-zinc-300 space-y-1">
          {branches.length ? branches.map((b: string) => (<li>{b}</li>)) : (<li class="text-zinc-500">No branches specified.</li>)}
        </ul>
        <div class="mt-3 text-xs text-zinc-500 dark:text-zinc-400">
          <strong>Reflect:</strong> {branchesReflection}
        </div>
      </div>
    </details>

    <!-- Leaves -->
    <details class="rounded-lg" role="group">
      <summary class="ttw-summary flex items-center gap-3 p-3 rounded-md hover:bg-zinc-50 dark:hover:bg-zinc-700">
        <svg class="ttw-arrow w-4 h-4 text-zinc-500" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
        <div class="text-sm font-medium text-slate-800 dark:text-zinc-100"> Leaves — Everyday actions</div>
      </summary>
      <div class="ttw-content p-4 bg-zinc-50 dark:bg-zinc-900 rounded-b-md">
        <ul class="list-disc list-inside text-sm text-zinc-700 dark:text-zinc-300 space-y-1">
          {leaves.length ? leaves.map((l: string) => (<li>{l}</li>)) : (<li class="text-zinc-500">No leaves specified.</li>)}
        </ul>
        <div class="mt-3 text-xs text-zinc-500 dark:text-zinc-400">
          <strong>Prompt:</strong> {leavesReflection}
        </div>
      </div>
    </details>

    <!-- Fruit -->
    <details class="rounded-lg" role="group">
      <summary class="ttw-summary flex items-center gap-3 p-3 rounded-md hover:bg-zinc-50 dark:hover:bg-zinc-700">
        <svg class="ttw-arrow w-4 h-4 text-zinc-500" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
        <div class="text-sm font-medium text-slate-800 dark:text-zinc-100"> Fruit — Visible outcomes</div>
      </summary>
      <div class="ttw-content p-4 bg-zinc-50 dark:bg-zinc-900 rounded-b-md">
        <ul class="list-disc list-inside text-sm text-zinc-700 dark:text-zinc-300 space-y-1">
          {fruit.length ? fruit.map((f: string) => (<li>{f}</li>)) : (<li class="text-zinc-500">No fruit specified.</li>)}
        </ul>
        <div class="mt-3 text-xs text-zinc-500 dark:text-zinc-400">
          <strong>Reflection:</strong> {fruitReflection}
        </div>
      </div>
    </details>
  </div>
</div>
