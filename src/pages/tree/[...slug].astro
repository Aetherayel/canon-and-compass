---
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection("fruit-path");
  const trees = entries
    .map((entry) => ({
      slug: entry.data?.tree?.slug,
      pathwayId: entry.data?.pathwayId ?? entry.slug,
    }))
    .filter((entry) => Boolean(entry.slug));

  return trees.map((tree) => ({
    params: { slug: tree.slug as string },
    props: { pathwayId: tree.pathwayId },
  }));
}

const { pathwayId } = Astro.props as { pathwayId?: string };
const target = pathwayId ? `/fruit-path/${pathwayId}` : "/fruit-path";
return Astro.redirect(target, 301);
---
